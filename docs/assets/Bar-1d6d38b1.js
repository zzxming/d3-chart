import{a as it,s as st,_ as dt}from"./LoadingTip.vue_vue_type_script_setup_true_lang-748e4402.js";import{z as ct}from"./zoom-a52d4bb0.js";import{d as X}from"./index-677af89f.js";import{m as O,s as ft}from"./Tableau10-36abeb1c.js";import{o as Y,I as H}from"./ordinal-2364f02c.js";import{r as Z}from"./range-6bc2a9a0.js";import{b as mt}from"./init-880e203b.js";import{m as q}from"./max-adfc8a60.js";import{a as J,b as K}from"./axis-a25b44c4.js";import{c as ut}from"./create-029c038a.js";import{b as Q}from"./linear-95918312.js";import{a as V}from"./axios-4a70c6fc.js";import{c as gt}from"./colors-98f238a0.js";import{d as pt,r as A,o as ht,n as xt,c as bt,b as vt,u as W,e as yt,f as wt}from"./index-194efed9.js";function M(){var n=Y().unknown(void 0),u=n.domain,_=n.range,l=0,s=1,g,x,f=!1,m=0,p=0,e=.5;delete n.unknown;function a(){var t=u().length,h=s<l,r=h?s:l,b=h?l:s;g=(b-r)/Math.max(1,t-m+p*2),f&&(g=Math.floor(g)),r+=(b-r-g*(t-m))*e,x=g*(1-m),f&&(r=Math.round(r),x=Math.round(x));var d=Z(t).map(function(v){return r+g*v});return _(h?d.reverse():d)}return n.domain=function(t){return arguments.length?(u(t),a()):u()},n.range=function(t){return arguments.length?([l,s]=t,l=+l,s=+s,a()):[l,s]},n.rangeRound=function(t){return[l,s]=t,l=+l,s=+s,f=!0,a()},n.bandwidth=function(){return x},n.step=function(){return g},n.round=function(t){return arguments.length?(f=!!t,a()):f},n.padding=function(t){return arguments.length?(m=Math.min(1,p=+t),a()):m},n.paddingInner=function(t){return arguments.length?(m=Math.min(1,t),a()):m},n.paddingOuter=function(t){return arguments.length?(p=+t,a()):p},n.align=function(t){return arguments.length?(e=Math.max(0,Math.min(1,t)),a()):e},n.copy=function(){return M(u(),[l,s]).round(f).paddingInner(m).paddingOuter(p).align(e)},mt.apply(a(),arguments)}const _t=n=>it(n[n.length-1]);var U=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(gt);_t(U);function Bt(n,u){let{x:_,y:l,z:s,title:g,marginTop:x=30,marginRight:f=0,marginBottom:m=30,marginLeft:p=40,width:e=640,height:a=400,xDomain:t,xRange:h=[p,e-f],xPadding:r=.1,yType:b=Q,yDomain:d,yRange:v=[a-m,x],zDomain:B,zPadding:C=.05,yFormat:D,yLabel:I="label for the y-axis",colors:N=ft}=u;const y=O(n,_),$=O(n,l),z=O(n,s);t===void 0&&(t=y),d===void 0&&(d=[0,q($)??0]),B===void 0&&(B=z);let i=new H(t),c=new H(B);const tt=Z(y.length).filter(o=>i.has(y[o])&&c.has(z[o])),L=M(i,h).paddingInner(r),P=M(c,[0,L.bandwidth()]).padding(C),k=b(d,v).nice(),F=Y(B,N),at=J(L).tickSizeOuter(0),et=K(k).ticks(a/60,D);let T;const G=k.tickFormat(100,D);if(g===void 0)T=(o,w,R,E)=>`
            ${w}
            <br />
            ${E}
            <br />
            ${G(Number(R))}
        `;else{const o=g;T=(w,R,E,lt)=>o(w,R,G(Number(E)),lt)}const S=ut("svg").attr("width",e).attr("height",a).attr("viewBox",[0,0,e,a]).attr("style","max-width: 100%; height: auto; height: intrinsic;").attr("color","#fff");let nt=S.append("g").attr("transform",`translate(${p},0)`),rt=o=>o.selectAll(".tick line").clone().attr("x2",e-p-f).attr("stroke-opacity",.1),ot=o=>o.append("text").attr("x",-p).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(I);nt.call(et).call(o=>o.select(".domain").remove()).call(rt).call(ot);const j=X().attr("class","d3_tip").offset([-10,0]).html((o,w)=>T(n[w],y[w],$[w],z[w]));return S.call(j),S.append("g").selectAll("rect").data(tt).join("rect").attr("x",o=>(L(y[o])??0)+(P(z[o])??0)).attr("y",o=>k($[o])).attr("width",P.bandwidth()).attr("height",o=>k(0)-k($[o])).attr("fill",o=>F(z[o])).on("mouseover",j.show).on("mouseleave",j.hide),S.append("g").attr("transform",`translate(0,${a-m})`).call(at),Object.assign(S.node(),{scales:{color:F}})}const zt=wt("div",{class:"chart_box"},null,-1),Nt=pt({__name:"Bar",setup(n){let u=A(!0),_=A(!1),l=A([]),s=async()=>{u.value=!0;let e=await new Promise(a=>{a(V.get("/d3json/Bar.json"))}).then(a=>a.data).catch(a=>{console.log(a),_.value=!0});u.value=!1,e&&(l.value=e)},g=async()=>{if(await s(),!l.value)return;const{innerWidth:e,innerHeight:a}=window,t={top:40,right:20,bottom:20,left:60},h=20,r=st(".chart_box").append("svg").attr("viewBox",[0,0,e,a]).attr("color","#fff"),b=X().attr("class","d3_tip").offset([-10,0]).html((i,c)=>`<span class="d3_tip-name">${c.name??"没有名字"}: ${c.value}</span>`);r.call(b);let d=M().domain(l.value.map(i=>`${i.name}`)).range([t.left,e-t.right]).padding(.1),v=Q().domain([0,q(l.value,i=>i.value)??0]).nice().range([a-t.bottom-h,t.top]),B=i=>i.attr("transform",`translate(0, ${a-t.bottom-h})`).attr("class","x-axis").call(J(d).tickSizeOuter(0)).call(c=>c.append("text").attr("x",e-120).attr("y",16+h).attr("fill","currentColor").attr("text-anchor","start").attr("font-size","16px").text("→ x轴说明文字")),C=i=>i.attr("transform",`translate(${t.left}, 0)`).attr("class","y-axis").call(K(v)).call(c=>c.select(".domain").remove()).call(c=>c.append("text").attr("x",-t.left/2).attr("y",t.top/2).attr("fill","currentColor").attr("text-anchor","start").attr("font-size","16px").text("↑ y轴说明文字")),D=r.append("g").attr("class","bars").selectAll("rect").data(l.value).join("rect").attr("x",i=>d(`${i.name}`)??0).attr("y",i=>v(i.value)).attr("height",i=>v(0)-v(i.value)).attr("width",d.bandwidth()).attr("fill","#aca").on("mouseover",b.show).on("mouseleave",b.hide),I=r.append("g");I.call(B),r.append("g").call(C);const y=[[t.left,t.top],[e-t.right,a-t.top]];function $(i){d.range([t.left,e-t.right].map(c=>i.transform.applyX(c))),D.attr("x",c=>d(`${c.name}`)??0).attr("width",d.bandwidth()),I.call(B)}let z=ct().scaleExtent([1,8]).translateExtent(y).extent(y).on("zoom",$);r.call(z)},x=A([]),f=A([]),m=async()=>{u.value=!0;let e=await new Promise(a=>{a(V.get("/d3json/GroupBar.json"))}).then(a=>a.data).catch(a=>{console.log(a),_.value=!0});u.value=!1,e&&(x.value=e.data,f.value=e.age)},p=async()=>{if(await m(),!x.value||!f.value)return;const{innerWidth:e,innerHeight:a}=window,t={top:40,right:20,bottom:20,left:60};let h=Bt(x.value,{x:r=>r.year,y:r=>r.value,z:r=>r.age,yLabel:"↑ 不知道什么数",zDomain:f.value,colors:U[f.value.length],marginBottom:t.bottom,marginLeft:t.left,marginRight:t.right,marginTop:t.top,width:e,height:a,title:(r,b,d,v)=>`<span class="d3_tip-name">${b}年，年龄${v}的人有${d}</span>`});document.getElementsByClassName("chart_box")[0].appendChild(h)};return ht(async()=>{await xt(),g(),p()}),(e,a)=>{const t=dt;return yt(),bt(t,{loading:W(u),loadError:W(_)},{default:vt(()=>[zt]),_:1},8,["loading","loadError"])}}});export{Nt as default};
